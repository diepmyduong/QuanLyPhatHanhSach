@using PagedList;
@using PagedList.Mvc;
@model PagedList.IPagedList<Core.BIZ.TheKho>

@{
    ViewBag.Title = "Tồn kho";
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
}

<h2>@ViewBag.Title</h2>
<hr />
<form action="TonKho" method="GET" class="form-horizontal" role="form">
	<div class="row">
		<div class="col-md-4 col-md-offset-4 text-center">
			<div class="form-group">
				<label for="date">Chọn ngày xem</label>
                @if (ViewBag.currentDate != null)
                        {
                            var currentDate = String.Format("{0:yyyy-MM-dd}",(DateTime)ViewBag.currentDate);
                    <input type="date" name="date" id="inputDate" class="form-control" required="required" title=""
                           value="@currentDate">
                }
                else
                {
                    <input type="date" name="date" id="inputDate" class="form-control" required="required" title=""
                           value="">
                }
			</div>
			<div class="form-group">
					<button type="submit" class="btn btn-primary">Xem</button>
			</div>
		</div>
	</div>
</form>
<hr />
@if (Model != null)
{
    using(Html.BeginForm("Index", "Sach", FormMethod.Get, new { @class = "form" }))
    {
        @Html.ValidationSummary(true)
        <div class="row ">
            <div class="col-md-10 form-group input-group">
                <input type="search" name="search" id="input" class="form-control"
                       value="@{if (ViewBag.SearchKey != null)
                            {
                                @ViewBag.SearchKey;
                            }
                            }"
                       required="required" title="">
                <span class="input-group-btn"><button class="btn btn-default" type="submit"><i class="fa fa-search"></i></button></span>
            </div>
        </div>
    }
    <table class="table">
        <tr>
            <th>
                @Core.DAL.TheKhoManager.Properties.MaSoSach
            </th>
            <th>
                @Core.DAL.TheKhoManager.Properties.Sach
            </th>
            <th>
                @Core.DAL.SachManager.Properties.TenTacGia
            </th>
            <th>
                @Core.DAL.TheKhoManager.Properties.SoLuong
            </th>
            <th>
                @Core.DAL.TheKhoManager.Properties.NgayGhi
            </th>
            <th></th>
        </tr>

        @foreach (var item in Model)
        {
            <tr>
                <td>
                    @Html.DisplayFor(modelItem => item.MaSoSach)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.Sach.TenSach)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.Sach.TenTacGia)
                </td>
                <td>
                    @String.Format("{0:0}", item.SoLuong)
                </td>
                <td>
                    @String.Format("{0:dd/MM/yyyy}",item.NgayGhi)
                </td>
                <td>
                    @Html.ActionLink("Edit", "Edit", "Sach", new { id = item.MaSoSach }, null) |
                    @Html.ActionLink("Details", "Details", "Sach", new { id = item.MaSoSach }, null)
                </td>
            </tr>
        }

    </table>
    <div class="row">
        <div class="col-md-4 col-md-offset-5">
            @Html.PagedListPager(Model, page => Url.Action("TonKho", new { page, pageSize = Model.PageSize, search = ViewBag.searchKey, date = ViewBag.currentDate}), PagedListRenderOptions.OnlyShowFivePagesAtATime)
        </div>
    </div>
    <div class="row">
        <div class="col-md-4 col-md-offset-5">
            Showing @Model.FirstItemOnPage to @Model.LastItemOnPage of @Model.TotalItemCount Contents.
        </div>
    </div>
}

